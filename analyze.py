import torch

src = torch.arange(1, 11).reshape((2, 5))

print(src)

index = torch.tensor([[0, 1, 2, 0, 0]])


a = torch.zeros(3, 5, dtype=src.dtype).scatter_(0, index, src)

print(a)

index = torch.tensor([[0, 1, 2], [0, 1, 4]])
b = torch.zeros(3, 5, dtype=src.dtype).scatter_(1, index, src)

print(b)

tensor([8227, 8086, 8223, 8141, 8161, 1998, 8069, 8181, 8089, 8088, 8216, 8230,
        8217,   86, 8108, 2999, 8157, 8201, 8065, 2078, 8121, 8214, 3592, 8068,
        8215, 8178,  224, 8137, 8221, 8156,   87, 8236, 8048, 8049, 8102, 8235,
        8195, 8158, 8072, 8159, 8109, 8136, 1970, 8192, 8155, 8160, 8084, 8180,
        8172, 3687, 8213, 8224, 3448, 8185, 2919, 8197, 8162, 8117, 2965, 8081,
        8134, 8200, 8046, 8138, 8127, 3641, 8248, 8110, 8196, 8090, 8169, 8151,
        8166, 8177, 8268, 8082, 8130, 8269, 8234, 8237, 8047, 8187, 8250, 8191,
        3528, 8167, 8392, 8071, 8193, 8139, 8186,   85, 8229, 8001, 8029, 8091,
        1966, 1993, 2070, 2998, 8249, 8182, 8352, 2057, 2246, 8061, 8101, 8171,
        3187, 8140, 8168, 8173, 8118, 8218, 3340, 8114, 2158, 8028, 8045, 8083,
          84, 8198, 3284, 8323, 1969, 8176, 2050, 8199, 8116, 8244, 3686, 8152,
        3449, 8070, 8267, 8041, 2806, 8122, 8210, 3363, 8384, 2069, 8115, 8154,
        1973, 1763, 8147, 8212, 3260, 8370, 2068, 8150, 3110, 8107, 8194, 3341,
        2148,  225, 1923, 8142, 8393, 2073, 8231, 1971, 8087, 8129, 2613, 8135,
        8188, 8030, 8291, 1988, 3191,  166, 2166, 1992, 2047, 8175, 2149, 3108,
        3527, 2058, 3642, 8099, 8220, 2692, 3443, 8119, 8050,  247, 2049, 2726,
        2245, 2326, 8383, 3420, 8391, 1831, 2173, 8361, 1968, 3158, 3722, 8324,
        2857, 2172, 2247, 8322, 8367, 1977, 1990, 3107, 8371, 2789, 1908, 3628,
        3180, 8302,  221, 3342, 2918, 1991, 8243, 2327, 8359, 2646, 2045, 3111,
        3369, 3607,   88, 8363, 8342, 3697, 3685, 8170, 3777, 2244, 8092,  229,
         143, 8330, 2092, 2165, 3204, 8179, 1967, 8113, 3186, 8148, 8346, 8120,
        8369, 8021, 8372, 8146, 2046, 3617, 8290, 2072, 3343, 2722, 3109, 8098,
        8204, 3447, 3261, 3721, 8153, 8165, 2061, 1965, 1984, 3195, 8097, 3259,
        8364, 3318, 3672, 8233, 8287,  167, 2693, 8000, 8353,  284, 1982, 8149,
        8282, 8094, 8096, 8266, 1902, 2403, 2803, 3100, 8007, 1212, 3283, 8241],
       device='cuda:0')